import numpy as np
import math
import csv
from scipy.optimize import curve_fit
from scipy.special import factorial
from scipy.stats import expon

trace = [131,6,18,46,10,153,8,32,76,44,123,18,10,52,6,147,14,44,66,0,135,10,16,48,2,155,8,26,74,12,127,16,12,46,8,143,16,38,54,4,131,18,8,50,0,152,9,50,58,10,131,8,14,44,12,143,18,40,52,8,119,20,8,54,0,152,11,48,50,2,129,8,18,44,12,118,47,24,66,6,95,36,18,56,2,127,44,46,48,2,108,24,43,48,10,136,27,54,44,12,123,16,10,52,8,147,12,56,54,0,133,10,16,50,2,84,53,50,42,10,127,18,14,44,6,147,18,54,52,4,130,17,8,50,2,159,6,42,64,10,110,29,12,46,12,117,40,77,79,8,125,12,8,56,0,154,13,62,50,2,129,8,18,44,10,151,16,32,60,16,125,18,6,56,4,135,36,18,54,26,132,9,16,48,10,153,8,42,56,12,123,16,10,54,8,147,12,40,54,0,88,55,16,52,2,117,41,51,50,10,118,25,14,44,6,128,39,36,52,4,103,35,32,50,2,157,6,48,46,10,131,6,14,46,12,147,16,42,52,8,147,38,32,78,24,181,34,46,106,24,146,41,42,68,34,173,40,70,70,32,146,45,30,76,28,181,38,60,74,26,153,38,40,72,32,165,42,74,68,54,161,52,34,76,32,156,48,58,79,26,157,34,38,74,24,177,34,60,68,32,153,36,40,66,32,175,40,64,74,30,141,52,30,76,28,174,35,46,102,30,157,30,38,72,34,169,38,84,72,34,144,43,34,76,26,145,59,93,72,26,131,58,40,70,30,162,73,64,112,32,151,40,32,72,32,136,62,93,74,28,139,50,36,74,30,152,56,89,70,34,122,66,76,77,32,167,44,82,74,26,150,43,36,74,26,177,34,58,94,30,157,34,40,70,32,145,65,53,72,34,141,50,32,76,28,141,71,84,76,28,127,56,44,72,32,158,51,60,70,34,127,68,46,78,26,163,48,56,76,28,155,34,38,70,30,179,34,72,70,32,133,56,32,72,32,175,40,62,74,28,155,32,36,76,28,177,34,70,70,32,149,36,38,70,34,151,56,68,74,26,126,59,40,76,28,144,67,54,68,30]

predict = []
old_v = 0

for i in trace:
    if i != 0:
        mean = 60 / i
        fit = expon(mean)
        v = math.ceil(60 / fit.ppf(0.05))
    else:
        v = old_v
    
    predict.append(v)
    old_v = v

print(predict)
